{% extends 'base.html' %}
{% block page_title %}Issue Tracker{% endblock %}
{% block page_heading %}Home Page{% endblock %}
{% block content %}
<div class = "row tracker-header text-center"><h1>Issues Tracker List</h1></div>

<table id ="table_id" class = "table-responsive table table-condensed">
        <thead class = "table thead-dark bordered">
            <!--<div class = "add-ticket-top"><a href="add"><button class ="btn btn-default"> Add a new item</button></a></div>-->
             <tr class="text-center">
                <td></td>
                <td>Upvote</td>
                <td>Name</td>
                <td>Content</td>
                <td>Submitted by</td>
                <td>Category</td>
                <td>Created on</td>
                <td>Upvotes</td>
                <td>Status</td>
                <td>Assigned to</td>
                <td>Completed on</td>
                <td>Progress</td>
                <td></td>
             </tr>
        </thead>
        <tbody class ="bordered">
             {% for item in items %}
            <!--provide bacground color to represent status-->
                {% if item.status == "Completed" %}
            <tr class = "text-center success">
                {% elif item.status == "Ongoing" %}
            <tr class = "text-center warning">  
                {% elif item.status == "Pending" %}
            <tr class = "text-center danger">
                {% endif %}
                <!--provide edit link-->
                {% if user.is_staff %}
                    <td>
                      {% if item.status == "Completed" %}
                         <form></form>
                      {% else %}
                        <form method="GET" action="edit/{{ item.id }}">
                           <button type="submit"data-toggle="tooltip" title="Click on icon to edit!">
                               <span class="glyphicon glyphicon-pencil" aria-hidden ="true"></span>
                            </button>    
                        </form>
                      {% endif %}
                    </td>
                {% else %}
                <td></td>
                {% endif %}
                    <td>
                {% if item.status == "Completed" %}
                    <form></form>
                {% else %}
                
                        {% if voteup == True %}
                            <a href ="{% url 'upvote' item.id %}" data-toggle="tooltip" title="Click on icon to upvote!">
                            <span class="glyphicon glyphicon-thumbs-up text-secondary" aria-hidden ="true"></span></a>
                        {% else %}
                            <a href ="{% url 'upvote' item.id %}" data-toggle="tooltip" title="Click on icon to upvote!">
                            <span class="glyphicon glyphicon-thumbs-up text-secondary" aria-hidden ="true"></span></a>
                          
                        {% endif %}
                 {% endif %}
                    </td>
                    <td>{{ item.name }}</td>
                    <td>{{ item.content }}</td>
                    <td>{{ item.user }}</td>
                    <td>{{ item.category }}</td>
                    <td>{{ item.created_date }}</td>
                    <td>{{ item.upvotes }}</td>
                    <td>{{ item.status }}</td>
                    <td>{{ item.assigned_to }}</td>
                    <td>{{ item.completed_date }}</td> 
                    <td>{{ item.progress }}</td>
                    <td>
                        {% if item.status == "Completed" %}
                         <form></form>
                      {% else %}
                        <a href ="{% url 'issue_detail' item.id %}" data-toggle="tooltip" title="Click on icon to view comments!">{{ comments.count }}<span class="glyphicon glyphicon-comment text-secondary" aria-hidden ="true"></span></a></a>
                      {% endif %}
                    </td>
            </tr>
            {% endfor %}  
        </tbody>
    </table>
{% if items.has_other_pages %}
  <ul class="pagination">
    {% if items.has_previous %}
      <li><a href="?page={{ items.previous_page_number }}">&laquo;</a></li>
    {% else %}
      <li class="disabled"><span>&laquo;</span></li>
    {% endif %}
    {% for i in items.paginator.page_range %}
      {% if items.number == i %}
        <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
      {% else %}
        <li><a href="?page={{ i }}">{{ i }}</a></li>
      {% endif %}
    {% endfor %}
    {% if items.has_next %}
      <li><a href="?page={{ items.next_page_number }}">&raquo;</a></li>
    {% else %}
      <li class="disabled"><span>&raquo;</span></li>
    {% endif %}
  </ul>
{% endif %}

{% endblock %}